{% if total_pages > 1 %}
<div class="pagination">
    {% if page > 1 %}
    <button hx-get="/search?query={{ query }}&page=1&per_page={{ per_page }}" hx-target="#search-results"
        hx-indicator=".htmx-indicator">
        First
    </button>
    <button hx-get="/search?query={{ query }}&page={{ page - 1 }}&per_page={{ per_page }}" hx-target="#search-results"
        hx-indicator=".htmx-indicator">
        Previous
    </button>
    {% endif %}

    {% for p in range(max(1, page - 2), min(total_pages + 1, page + 3)) %}
    {% if p == page %}
    <span class="current-page">{{ p }}</span>
    {% else %}
    <button hx-get="/search?query={{ query }}&page={{ p }}&per_page={{ per_page }}" hx-target="#search-results"
        hx-indicator=".htmx-indicator">
        {{ p }}
    </button>
    {% endif %}
    {% endfor %}

    <button hx-get="/search?query={{ query }}&page={{ page + 1 }}&per_page={{ per_page }}" hx-target="#search-results"
        hx-indicator=".htmx-indicator">
        Next
    </button>

    {% if page < total_pages %} <button
        hx-get="/search?query={{ query }}&page={{ total_pages }}&per_page={{ per_page }}" hx-target="#search-results"
        hx-indicator=".htmx-indicator">
        Last
        </button>
        {% endif %}
</div>
{% endif %}