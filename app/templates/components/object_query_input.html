<div class="object-query-input">
    <input type="text" name="object_name" placeholder="Object name" hx-on="change: updateObjectQueryJson()">
    <input type="number" name="object_count" placeholder="Count" min="1" hx-on="change: updateObjectQueryJson()">
    <button hx-get="/remove_object_query" hx-target="closest div.object-query-input" hx-swap="outerHTML">Remove</button>
</div>

<script>
    function updateObjectQueryJson() {
        let objectQuery = {};
        document.querySelectorAll('.object-query-input').forEach(input => {
            let name = input.querySelector('[name="object_name"]').value;
            let count = input.querySelector('[name="object_count"]').value;
            if (name && count) {
                objectQuery[name] = parseInt(count);
            }
        });
        document.getElementById('object_query_json').value = JSON.stringify(objectQuery);
    }
</script>